<!DOCTYPE html><html><head>	<meta charset="utf-8">	<meta name="viewport" content="width=device-width, initial-scale=1">	<title>JuRo CHAT</title>	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>		<link rel="stylesheet" href="themes/myTheme.css" />	<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script><style type="text/css">body {    background: url(image2.jpg);    background-repeat:repeat-y;    background-position:center center;    background-attachment:scroll;    background-size:100% 100%;}.ui-page {    background: transparent;}.ui-content{    background: transparent;}</style>	<style>#signup label.error {  font-size: 0.8em;  color: #F00;  font-weight: bold;  display: block;  margin-left: 215px;}#signup  input.error, #signup select.error  {  background: #FFA9B8;  border: 1px solid red;}</style><script>var f=0;//document.getElementById('logout1').style.visibility='hidden';function statusChangeCallback(response) {				console.log('statusChangeCallback');				console.log(response);				temp=response;				// The response object is returned with a status field that lets the			// app know the current login status of the person.			// Full docs on the response object can be found in the documentation			// for FB.getLoginStatus().				if (response.status === 'connected') {				console.log("user has logged in ");			// Logged into your app and Facebook.				//document.getElementById("logout").style.display='block';			var query_string = {};			var query = window.location.search.substring(1); //start with question mark			console.log(query);			var vars = query.split("=");			console.log(vars[0]);			console.log(vars[1]);						if(vars[0]=="logout" && vars[1]=="true")			{				f=1;				logout();				return;			}					testAPI();				} else if (response.status === 'not_authorized') {			// The person is logged into Facebook, but not your app.					document.getElementById('status').innerHTML = 'Please log ' +        'into this app.';				} else {				console.log(response.status);					//alert("YOU Logged out");			// The person is not logged into Facebook, so we're not sure if			// they are logged into this app or not			document.getElementById('status').innerHTML = '';				}			}					function checkLoginState() {   							FB.getLoginStatus(function(response) {				statusChangeCallback(response);				});			}	window.fbAsyncInit = function() {  FB.init({    appId      : '1202556679758091',    cookie     : true,  // enable cookies to allow the server to access                         // the session    xfbml      : true,  // parse social plugins on this page    version    : 'v2.2' // use version 2.2  });  // Now that we've initialized the JavaScript SDK, we call   // FB.getLoginStatus().  This function gets the state of the  // person visiting this page and can return one of three states to  // the callback you provide.  They can be:  //  // 1. Logged into your app ('connected')  // 2. Logged into Facebook, but not your app ('not_authorized')  // 3. Not logged into Facebook and can't tell if they are logged into  //    your app or not.  //  // These three cases are handled in the callback function.  FB.getLoginStatus(function(response) {    statusChangeCallback(response);  });  };  			(function(d, s, id) {				var js, fjs = d.getElementsByTagName(s)[0];				if (d.getElementById(id)) return;				js = d.createElement(s); js.id = id;				js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4&appId=1202556679758091";				fjs.parentNode.insertBefore(js, fjs);			}(document, 'script', 'facebook-jssdk'));  			//This function gets the status of the current logged in user  						function testAPI() {						var value,username;			var friends=new Array();				console.log('Welcome!  Fetching your information.... ');				FB.api('/me/',{locale:'en_US',fields:'name,email'}, function(response) {					console.log('Successful login for: ' + response.name);					username=response.name;					emailid=response.email;					//document.getElementById('status').innerHTML = 'Thanks for logging in, ' + response.name + '!' +response.email;				});						FB.api('/me/friends', function(response) {														if(response.data)					{						value1="yy";						document.getElementById("status").innerHTML="<br>";						//document.getElementById("status").innerHTML="Here are your friends list<br>";						//console.log(JSON.stringify(response.data));						var items = document.getElementById("status");												for( var key in response.data)						{						//console.log(response.data[key].name);							$("#status").append("<ul id='list' data-role='listview' data-inset='true'></ul>");							$("#status").trigger("create");							var action_list_ul = document.getElementById('list');							action_list_ul.addEventListener("click", myfunc, false);							 value = response.data[key].name;							 //friends.push(value);							 friends.push(value);							 //console.log(friends);						//var listItem = "<li>" + "<a  href='javascript:myfunc(this)'>" + value + "</a>" +"</li>";						//var listItem = "<li>" + "<a  href='#'>" + value + "</a>" +"</li>";						//document.getElementsByTagName('a').setAttribute('id',value);						//$("#list").append(listItem);						//$("#list").listview("refresh");												}																			}						friends.push(username);						friends.push(emailid);						var friend=JSON.stringify(friends);						//friend=friend.concat(username);						console.log(friend);												function escapeHtml(text) {  var map = {    '&': '&amp;',    '<': '&lt;',    '>': '&gt;',    '"': '&quot;',    "'": '&#039;'  };  return text.replace(/[&<>"']/g, function(m) { return map[m]; });}//if(f==0){					$('<form enctype="application/json" action="homepage.php" method="POST">' +   '<input type="hidden" name="json" value="' + escapeHtml(friend)+ '">' +  '</form>').submit(); //}																	});												}function myfunc(e){if(e.target.nodeName=="A"){var val= e.target.innerHTML;}document.getElementById('name').value=username;//var val=document.getElementById('chat').value;document.getElementById('friend').value=val;document.getElementById('theForm').submit();}function logout(){	FB.logout(function(response){	//window.location.reload();	window.location.href="frontpage.html";	});	return;}</script>		<form method="post" id="theForm" action="jurochat_work.php">			<input type="hidden" name="name" id="name">			<input type="hidden" name="friend"id="friend">		</form>	<script type="text/javascript">	//$('#logout1').closest('.ui-btn').hide();	//$(document).ready(function(){	//$("#chat").bind('click', function(){		//	console.log("Hit here");		//$.post("jurochat.php", {name:username,friend:value});							//	return false;	//}); //});</script></head><body><div data-role="page" id="page1">		<div data-role="header">			<h1>JuRo CHAT</h1>		</div>		<div data-role="main" class="ui-content">		<h5>New to JuROCHAT??<a href="#popupBasic1" data-rel="popup">SignUp</a> here</h5>			<h5>Already a user??<a href="#popupBasic" data-rel="popup">Login</a></h5>			<div class="ui-dialog" id="popupBasic2" style="display:none;"> </div>			<div id="fb-root"></div><!----It's the place holder for the Facebook javascript script to attach elements to the DOM. Without this when the referenced Facebook script is ran it has nowhere to attach elements.-->			<div class="fb-login-button" data-max-rows="2" data-size="small" data-show-faces="true" scope="public_profile,email,user_friends" onlogin="checkLoginState();"></div>			<div id="status"></div>			<!--<input type="button" value="logout" id="logout1" class="ui-btn-hide" data-inline="true" aria-disabled="false"/> -->					</div><!-- pop up for login starts here -->		<div data-role="popup" id="popupBasic" data-transition="pop" data-theme="a" class="ui-corner-all">			<form action="login_page.php" method="post" name="signin" id="signin">				<div style="padding:10px 20px;">				  <h3>Please sign in</h3>		          <label for="email" class="ui-hidden-accessible">Email:</label>		          <input type="email" name="email" id="email" value="" placeholder="email" data-theme="a" />		          <label for="password" class="ui-hidden-accessible">Password:</label>		          <input type="password" name="password" id="password" value="" placeholder="password" data-theme="a" />		    	  <input type="submit" value="Login" data-theme="b"/>		    	   				</div>			</form>		</div>						<!-- pop up for sign up starts here -->	<div data-role="popup" id="popupBasic1" data-transition="pop" data-theme="a" class="ui-corner-all">		     <!--  <div role="main" class="ui-content"> -->    <form action="register1.php" method="post" name="signup" id="signup">    	<div style="padding:10px 20px;">    		<h3>Please fill your details..</h3>    	 <label for="un" class="ui-hidden-accessible">Firstname:</label>		 <input type="text" name="firstname" id="firstname" value="" placeholder="firstname" data-theme="a" />		 <label for="un" class="ui-hidden-accessible">Lastname:</label>		 <input type="text" name="lastname" id="lastname" value="" placeholder="lastname" data-theme="a" />	     <label for="un" class="ui-hidden-accessible">E-mail Address:</label>		 <input type="text" name="email" id="email" value="" placeholder="email" data-theme="a" />		  <label for="un" class="ui-hidden-accessible">Password:</label>		  <input type="password" name="password" id="password" value="" placeholder="password" data-theme="a" />		  <label for="un" class="ui-hidden-accessible">Re-enter Password:</label>		  <input type="password" name="confirm_password" id="confirm_password" value="" placeholder="re-enter password" data-theme="a" />			 			<input type="submit" value="Register" data-theme="b"/> 						</div>	</form>     </div><!-- /content -->    <div id="displaysignin" style="display:none;"></div>    <!--<div id="displaysignup" style="display:none;"></div>-->	<div id="displaysignup"></div>	<div data-role="footer" data-position="fixed">		<h2>&copy; CMPE220 JuRoCHAT Fall'15</h2>	</div></div><script type="text/javascript">$(function() {//alert("Inside signin");$("#signin").submit(function(){var data = $('#signin').serialize();//alert(data);$.ajax({    url: "login_page.php",    type: "POST",    data: data,    dataType: 'json',    success: function(data)     {    		if (data.status == 401)  		{			console.log(data);            //$('#displaysignin').html(data.msg).show();  			alert(data.msg);        }        else if(data.status == 200)        {							                  window.location.replace(data.url);        }     },    error : function(data)    {		console.log(data);        //$(this).dialog("close");    }    });     return false; });	$("#signup").submit(function(){	var dataSignup = $('#signup').serialize();	var datas=JSON.stringify(dataSignup);	console.log("Got data for signup"+datas);	//alert(dataSignup);	$.ajax({	    url: "register1.php",	    type: "POST",		data: dataSignup,	    dataType:"json",		success: function(data)     	{  			console.log(data);	  		if (data.status == 401)	  		{					            //$('#displaysignup').html(data.msg).show();  				alert(data.msg);	        }	        else if(data.status == 200)	        {			        		var name=$("#firstname").val();					//$("#popupBasic2").dialog('open');					alert("Registration Successful. Please login  "+name);	                window.location.replace(data.url);	        }     	},	    error : function(data)	    {			alert("hit error");	        //$(this).dialog(hiclose");			//var json = $.parseJSON(data);			console.log(data);	    }	    });     	return false; 	});});</script></body></html>